# pindol

Main code that performs dynamics in the NVE and NVT ensembles. 

## Installation

The code requires a fortran compiler (tested with gfortran 11.3.0). After cloning, from this folder it is enough to type

`make`

If the compilation ends successfully, the executable pindol is created.

For the integration of the equation of motion, the code makes use of the [DVODE](https://computing.llnl.gov/sites/default/files/dvode.f) subroutine.


## Usage

The files that must be present in the folder where the code is executed are:

- qmatrix.nd and freq.nd generated by [QPOINTS](https://github.com/acammarat/phtools/tree/main/qpoints), and phi.nd generated by [phind](https://github.com/acammarat/pindol/tree/main/phind);
- the geometry reference file in [LAMMPS](https://www.lammps.org) or [VASP](https://www.vasp.at) POSCAR format

An initial configuration (i.e., atomic positions and velocities) can be provided as a file in LAMMPS or POSCAR format; alternatively, the velocities can be initialized before starting the simulation through the INITVEL keyword (see below).

The settings are specified in the `pindol.inp` file. The file must contain the ATOMS block, with information on the atomic types:

```

ATOMS
types int # how many atom types
atom string double # name of the atom, atomic mass (amu)
END_ATOMS

```

where the number of atomic types must preceed the list of the atoms. The ND block is optional, and specifies the ND run:

```

ND

nve # NVE ensemble

or

nvt double double double # NVT ensemble with initial and final temperature (K) followed by the step (K) used for a linear ramp change of the temperature; if initial and final temperatures are the same, the temperature is not changed during the simulation
integrator double 22 both 1.d-15 # integration time step followed by the options for the textscdvode solver
runsteps int # number of integration steps
printcoord int normcoord.dat # writing frequency of the normal coordinats file (e.g. normcoord.dat)
printvel int normvel.dat # writing frequency of the normal velocities file (e.g. normvel.dat)
printacc int normacc.dat # writing frequency of the normal accelerations file (e.g. normacc.dat)
END_ND
```

Mandatory keywords are:

```

REFCONF poscar/lammps POSCAR # reference geometry file (e.g. POSCAR) in POSCAR or LAMMPS format.
UNITS real/metal # units for the output; real = time in fs, energy in joule

```

Moreover, optional keywords can be specified:

```

DISTORT int double all # seed for the random number generation, maximum amplitude of atomic displacements in AA, keyword ``all''

or, to distort the structure along specific normal coordinates

DISTORT int double int int ... # seed for the random number generation, maximum amplitude of atomic displacements in AA, number of normal modes along which the distortions will be applied, pair(s) specifying the q-point and the mode
INITCONF poscar/lammps POSCAR.init # initial atom positions and velocities in POSCAR or textsclammps format are taken from the, e.g., POSCAR.init; the geometry must be a supercell commensurate with the q-set
INITVEL double int # velocities are initialized from a Gaussian distribution at the specified temperature; the next argument is the seed for the random number generator. Initial positions and velocities are written in the file specified by FINALCONF and the execution is terminated if the ND block is not provided.
FINALCONF poscar/lammps final.vasp # atom geometry and velocities calculated at the last step of the ND run or with the INITVEL keyword; the geometry is a supercell commensurate with the $bmq$ set
WRITERESTART final.restart # at the end  of the simulation, the restart file (e.g. final.restart) containing the final atom geometry and velocities is written; if the NVT ensemble is specified, the thermostat status is also written.
READRESTART init.restart # file (e.g. init.restart) used to continue the simulation
```

The last line of the setting file must contain the keywork END; any keyword after that is ignored.

The code is executed with the command

```

pindol

```

The standard output contains information on the energy, the conserved quantity and the temperature at each time step. If the environmental variable OMP_NUM_THREADS is specified, pindol exploits the OpenMP parallelization.

## Examples

- [Cristalline Si](https://github.com/acammarat/pindol/tree/main/pindol/examples/si)
- [MoS<sub>2</sub>/MoSe<sub>2</sub>](https://github.com/acammarat/pindol/tree/main/pindol/examples/msmse) van der Waals bilayer

## Citation

The users of PINDOL have little formal obligations specified in the [GNU General Public License](https://www.gnu.org/licenses/old-licenses/gpl-2.0.txt).
However, it is common practice in the scientific literature, to acknowledge the efforts of people that have made the research possible.
In this spirit, please cite

A. Cammarata, M. Dasic and P. Nicolini, *Integrating Newton's equations of motion in the reciprocal space*, Journal of Chemical Physics, **161**, 084111 (2024) DOI: [10.1063/5.0224108](https://doi.org/10.1063/5.0224108)

where the formulation used to perform normal dynamics is reported.

