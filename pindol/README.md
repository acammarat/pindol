# pindol

Main code that performs dynamics in the NVE and NVT ensembles. 

## Installation

The code requires a fortran compiler (tested with gfortran 11.3.0). After cloning, from this folder it is enough to type

`make`

If the compilation ends successfully, the executable pindol is created.

For the integration of the equation of motion, the code makes use of the [DVODE](https://computing.llnl.gov/sites/default/files/dvode.f) subroutine.


## Usage

The files that must be present in the folder where the code is executed are:

- qmatrix.nd and freq.nd generated by [QPOINTS](https://github.com/acammarat/phtools/tree/main/qpoints), and phi.nd generated by [phind](https://github.com/acammarat/pindol/tree/main/phind);
- the geometry reference file in [LAMMPS](https://www.lammps.org) or [VASP](https://www.vasp.at) POSCAR format

An initial configuration (i.e., atomic positions and velocities) can be provided as a file in \textsc{lammps} or POSCAR format;
%
alternatively, the velocities can be initialized before starting the simulation through the INITVEL keyword (see below).
%
The settings are specified in the \texttt{pindol.inp} file.
%
The file must contain the \textbf{ATOMS block}, with information on the atomic types:

{\parindent0pt\vspace{0.2cm}
ATOMS

\texttt{types} \textit{int} \# how many atom types

\texttt{atom} \textit{string} \textit{double} \# name of the atom, atomic mass (amu)

END\_ATOMS

\vspace{0.2cm}

where the number of atomic types must preceed the list of the atoms.
% 
\textbf{The ND block} is optional, and specifies the ND run:

\clearpage

\vspace{0.2cm}

ND

\texttt{nve} \# NVE ensemble

or

\texttt{nvt} \textit{double double double} \# NVT ensemble with initial and final temperature (K) followed by the step (K) used for a linear ramp change of the temperature; if initial and final temperatures are the same, the temperature is not changed during the simulation

\texttt{integrator} \textit{double} 22 both 1.d-15 \# integration time step followed by the options for the \textsc{dvode} solver

\texttt{runsteps} \textit{int} \# number of integration steps

\texttt{printcoord} \textit{int} normcoord.dat \# writing frequency of the normal coordinats file (e.g. \texttt{normcoord.dat})

\texttt{printvel} \textit{int} normvel.dat \# writing frequency of the normal velocities file (e.g. \texttt{normvel.dat})

\texttt{printacc} \textit{int} normacc.dat \# writing frequency of the normal accelerations file (e.g. \texttt{normacc.dat})

END\_ND
\vspace{0.2cm}

Mandatory keywords are:

\vspace{0.2cm}
REFCONF \texttt{poscar/lammps} POSCAR \# reference geometry file (e.g. POSCAR) in POSCAR or LAMMPS format.

UNITS \texttt{real/metal} \# units for the output; \texttt{real} = time in fs, energy in joule
\vspace{0.2cm}

Moreover, optional keywords can be specified:

\vspace{0.2cm}
DISTORT \textit{int double} \texttt{all} \# seed for the random number generation, maximum amplitude of atomic displacements in \AA{}, keyword ``all''

or, to distort the structure along specific normal coordinates

DISTORT \textit{int double int int} $\dots$ \# seed for the random number generation, maximum amplitude of atomic displacements in \AA{}, number of normal modes along which the distortions will be applied, pair(s) specifying the $\bm{q}$-point and the mode

INITCONF \texttt{poscar/lammps} POSCAR.init \# initial atom positions and velocities in POSCAR or \textsc{lammps} format are taken from the, e.g., POSCAR.init; the geometry must be a supercell commensurate with the $\{q\}$ set
\vspace{0.1cm}

INITVEL \textit{double int} \# velocities are initialized from a Gaussian distribution at the specified temperature; the next argument is the seed for the random number generator. Initial positions and velocities are written in the file specified by FINALCONF and the execution is terminated if the ND block is not provided.
\vspace{0.1cm}

FINALCONF \texttt{poscar/lammps} final.vasp \# atom geometry and velocities calculated at the last step of the ND run or with the INITVEL keyword; the geometry is a supercell commensurate with the $\{\bm{q}\}$ set
\vspace{0.1cm}

WRITERESTART \texttt{final.restart} \# at the end  of the simulation, the restart file (e.g. \texttt{final.restart}) containing the final atom geometry and velocities is written; if the NVT ensemble is specified, the thermostat status is also written.
\vspace{0.1cm}

READRESTART \texttt{init.restart} \# file (e.g. \texttt{init.restart}) used to continue the simulation
\vspace{0.2cm}
}

{\parindent0pt
The last line of the setting file must contain the keywork END; any keyword after that is ignored.
%
The code is executed with the command

\vspace{0.2cm}
\texttt{pindol}
\vspace{0.2cm}

The standard output contains information on the energy, the conserved quantity and the temperature at each time step.
%
If the environmental variable OMP\_NUM\_THREADS is specified, \texttt{pindol} exploits the OpenMP parallelization.
}
## Example

XXX {Magari possiamo metterci lo zirconio? (il template.inp e' per Zr...)}

## Citation

The users of PINDOL have little formal obligations specified in the [GNU General Public License](https://www.gnu.org/licenses/old-licenses/gpl-2.0.txt).
However, it is common practice in the scientific literature, to acknowledge the efforts of people that have made the research possible.
In this spirit, please cite

A. Cammarata, M. Dasic and P. Nicolini, *Normal Dynamics: solving Newtonâ€™s equations in the reciprocal space*, Phys. Rev. Lett **XX**, XXXXX (XXXX) DOI: [xxx](https://doi.org/10.1103/xxx)

A. Cammarata, M. Dasic and P. Nicolini, *Sampling dynamical trajectories in the reciprocal space*, Phys. Rev. B **XX**, XXXXX (XXXX) DOI: [xxx](https://doi.org/10.1103/xxx)

where the formulation used to perform normal dynamics is reported.

